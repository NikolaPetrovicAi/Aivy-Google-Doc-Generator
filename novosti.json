{
  "name": "AI News â†’ OpenAI â†’ Google Doc (daily)",
  "nodes": [
    {
      "parameters": {},
      "id": "ManualTrigger",
      "name": "Manual Trigger",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [260, 180]
    },
    {
      "parameters": {
        "functionCode": "const now = new Date();\nconst start = new Date(Date.now() - 24*60*60*1000);\nconst yyyy = now.getFullYear();\nconst mm = String(now.getMonth()+1).padStart(2,'0');\nconst dd = String(now.getDate()).padStart(2,'0');\nconst title = `AI_News_${yyyy}-${mm}-${dd}`;\nreturn [{ startISO: start.toISOString(), endISO: now.toISOString(), docTitle: title, today: `${dd}.${mm}.${yyyy}` }];"
      },
      "id": "ComputeWindow",
      "name": "Compute Window (24h + title)",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [520, 180]
    },
    {
      "parameters": { "url": "https://techcrunch.com/feed" },
      "id": "RSS_TC",
      "name": "RSS: TechCrunch",
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1,
      "position": [520, 20]
    },
    {
      "parameters": { "url": "https://venturebeat.com/category/ai/feed/" },
      "id": "RSS_VB",
      "name": "RSS: VentureBeat AI",
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1,
      "position": [520, 340]
    },
    {
      "parameters": { "url": "https://bensbites.beehiiv.com/feed" },
      "id": "RSS_BB",
      "name": "RSS: Ben's Bites",
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1,
      "position": [520, 520]
    },
    {
      "parameters": { "mode": "combine" },
      "id": "Merge1",
      "name": "Merge TC + VB",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 2,
      "position": [760, 180]
    },
    {
      "parameters": { "mode": "combine" },
      "id": "Merge2",
      "name": "Merge All ( + Ben's Bites )",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 2,
      "position": [980, 180]
    },
    {
      "parameters": {
        "functionCode": "const startISO = $items('Compute Window (24h + title)', 0, 0).json.startISO;\nconst start = new Date(startISO);\nfunction host(u){ try { return new URL(u).hostname; } catch(e){ return ''; } }\nconst out = [];\nfor (const it of items) {\n  const j = it.json;\n  const pub = j.isoDate || j.pubDate || j.pubdate || j.date || null;\n  const d = pub ? new Date(pub) : null;\n  if (!d || d < start) continue;\n  out.push({\n    title: j.title || '(no title)',\n    link: j.link || j.guid || '',\n    source: j.meta && j.meta.title ? j.meta.title : host(j.link || ''),\n    publishedAt: d.toISOString()\n  });\n}\n// sort desc\nout.sort((a,b)=> new Date(b.publishedAt)-new Date(a.publishedAt));\nreturn out.map(o=>({json:o}));"
      },
      "id": "FilterLast24h",
      "name": "Filter + Normalize (24h)",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [1200, 180]
    },
    {
      "parameters": {
        "functionCode": "const itemsArr = items.map(i=>i.json);\nconst textForAI = JSON.stringify(itemsArr.slice(0, 20)); // max 20 stavki\nreturn [{ items: itemsArr, aiInput: textForAI }];"
      },
      "id": "PackForAI",
      "name": "Pack for OpenAI",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [1420, 180]
    },
    {
      "parameters": {
        "operation": "completeChat",
        "model": "gpt-4o-mini",
        "messages": [
          {
            "text": "SaÅ¾mi sledeÄ‡e AI/Tech vesti u 6â€“8 reÄenica. Istakni kompanije, proizvode/model-e i trend. Bez clickbait-a. Na kraju dodaj 1â€“2 reÄenice zakljuÄka.\n\nVesti (JSON): {{$json[\"aiInput\"]}}",
            "type": "system"
          }
        ]
      },
      "id": "OpenAI",
      "name": "OpenAI: Summarize",
      "type": "n8n-nodes-base.openAi",
      "typeVersion": 1,
      "position": [1640, 180],
      "credentials": { "openAiApi": { "id": "", "name": "YOUR_OPENAI_API_KEY" } }
    },
    {
      "parameters": {
        "documentName": "={{$items('Compute Window (24h + title)',0,0).json.docTitle}}"
      },
      "id": "GDocsCreate",
      "name": "Google Docs: Create (daily)",
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [1860, 120],
      "credentials": { "googleDocsOAuth2Api": { "id": "", "name": "YOUR_GOOGLE_OAUTH2" } }
    },
    {
      "parameters": {
        "documentId": "={{$json[\"documentId\"]}}",
        "text": "={{\"ðŸ“… \" + $items('Compute Window (24h + title)',0,0).json.today + \" â€” AI & Tech Highlights\\n\\n\" + $items('OpenAI: Summarize',0,0).json.text + \"\\n\\nðŸ—žï¸ Linkovi:\\n\" + $items('Pack for OpenAI',0,0).json.items.map(i=>`â€¢ ${i.title} â€” ${i.link}`).join('\\n') + \"\\n\\nâ€” Generated via n8n\"}}",
        "options": { "appendAt": "end" }
      },
      "id": "GDocsAppend",
      "name": "Google Docs: Append",
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [2060, 120],
      "credentials": { "googleDocsOAuth2Api": { "id": "", "name": "YOUR_GOOGLE_OAUTH2" } }
    }
  ],
  "connections": {
    "Manual Trigger": { "main": [[{ "node": "Compute Window (24h + title)", "type": "main", "index": 0 }]] },
    "RSS: TechCrunch": { "main": [[{ "node": "Merge TC + VB", "type": "main", "index": 0 }]] },
    "RSS: VentureBeat AI": { "main": [[{ "node": "Merge TC + VB", "type": "main", "index": 1 }]] },
    "Merge TC + VB": { "main": [[{ "node": "Merge All ( + Ben's Bites )", "type": "main", "index": 0 }]] },
    "RSS: Ben's Bites": { "main": [[{ "node": "Merge All ( + Ben's Bites )", "type": "main", "index": 1 }]] },
    "Merge All ( + Ben's Bites )": { "main": [[{ "node": "Filter + Normalize (24h)", "type": "main", "index": 0 }]] },
    "Filter + Normalize (24h)": { "main": [[{ "node": "Pack for OpenAI", "type": "main", "index": 0 }]] },
    "Pack for OpenAI": { "main": [[{ "node": "OpenAI: Summarize", "type": "main", "index": 0 }]] },
    "Compute Window (24h + title)": { "main": [[{ "node": "Google Docs: Create (daily)", "type": "main", "index": 0 }]] },
    "Google Docs: Create (daily)": { "main": [[{ "node": "Google Docs: Append", "type": "main", "index": 0 }]] }
  }
}
